## Hidden (почти) [medium]
450
reverse medium

# Автор: gr8str8some1
# Решил: gr8str8some1

> Описание: Этот исполняемый файл скрывает свой секрет, и он не появится на экране по волшебству. Похоже, что ключ к разгадке лежит глубже, чем кажется на первый взгляд...<br>
(может, недостаточно смотреть только на вывод программы?...)<br>

# Решение:
> [!TIP] Основная зацепка в задаче:
> ![img_8.png](images/img_8.png)


Запускаемся в IDA. В отличие от предыдущих задач, где был exe-шник, тут уже Elf. Этот бинарь уже под unix.<br>
А значит, и IDA нам нужна на линуксе. (Либо на винде оставляем, но тогда нужен будет remote linux debugger подключить к линуксу по гайдам от нейронки/интернету, чтобы работать в отладке эльфа на винде)<br>
Открыв, можем найти функцию main слева так же по поиску ctrl+f (нужно заранее нажать на какую-то функцию, чтобы поиск был именно среди функций, а не по строкам например в дизассемблере/всей проге)<br>
![img.png](images/img.png)

Т.к. мы работаем в линухе, у нас ввод будет осуществляться консольно, а ждать этот вод будет ida в том же месте, откуда мы и запускали иду.<br>
Запустили локальную отладку на линуксе и посмотрим, может программа чего-то от нас требует, чтобы найти "точку", от которой можно оттолкнуться, по сути своего рода артефакт.<br>

Да, так и есть, ожидается ввод флага.<br>
![img_1.png](images/img_1.png)

Но, нам этого мало, поэтому введём что-нибудь, чтобы уйти в ветку "неверно указан флаг"<br>
![img_2.png](images/img_2.png)

Таки действительно, такая надпись есть и вот уже два артефакта.<br>
Поищем, где именно в программе находится строка с "Wrong флаг"<br>

> [!TIP] Дружеское напоминание:
> Ctrl+f -> вписываем -> дальше везде шмалаем на энтеры.
> Таб/пробел - переключение между графовым представлением/дизассемблером/декомпилятором
> F2 - брейкпоинт

Ставим брейкпоинт на строку с Wrong Флаг.<br>
![img_3.png](images/img_3.png)

Заново запускаем заново вводим что угодно<br>
И теперь мы остановились на брейкпоинте<br>
![img_4.png](images/img_4.png)

Теперь нужно синхронизовать hex-view, stack-view c нашим IDA View RIP<br>
Тыкаем по пустому месту в Stack view<br>
![img_5.png](images/img_5.png)

И по аналогии по пустому месту в Hex view<br>
![img_6.png](images/img_6.png)

И везде надо поставить галочку IDA View RIP, во всех окошках, чтобы всё синхронизировать.<br>
Это нужно для того, чтобы когда мы листали наш дизассемблер, вместе с ним листался и стек, и hex, чтобы сразу видеть, не упускаем ли мы что-то<br>

Дальше нажимаем на r12 в регистрах (на стрелочку)<br>
![img_7.png](images/img_7.png)

И, т.к. мы синхронизировали везде окна, в hex view можно будет увидеть флаг.