## Apchi! [easy]
350
reverse easy

# Автор: gr8str8some1
# Решил: gr8str8some1

> Описание:<br>
 \- UPXchi!<br>
 \- Будьте здоровы!".<br>
  Кто-то явно простудился, запаковывая этот файл.<br>

# Решение:
Воспользуемся программой DIE (detect it easy)<br>
![img.png](images/img.png)

Видим, что есть упаковщик UPX.<br>
Пробуем засунуть в IDA, посмотрим, что нас ждёт<br>
![img_1.png](images/img_1.png)

Судя по графическому представлению, большое количество разветвлений, трудно анализируемая логика, и куча обфускации<br>
Есть несколько способов решить данную проблему:<br>

**Способ 1**<br>

Посмотрим сигнатуру файла через hexedit<br>
![img_2.png](images/img_2.png)
![img_3.png](images/img_3.png)

Как мы видим, помимо "UPX1, UPX2.." есть и "UPX!". Вот эту штуку можно поломать любым изощрённым способом, и всё будет ок<br>

**Способ 2**<br>

Второй же способ - воспользоваться "распаковщиком"<br>
![img_4.png](images/img_4.png)

После чего, достанется распакованный exe-шник. Его уже можно запускать<br>
Запустив, у нас открывается консоль и сразу же закрывается.<br>
Что-то здесь не ладно... Зайдем в IDA и поставим брейкпоинт (F2) на последнем return перед завершением программы, чтобы словить "конечное" состояние.<br>
![img_5.png](images/img_5.png)

Смотрим, что получилось:<br>
![img_6.png](images/img_6.png)